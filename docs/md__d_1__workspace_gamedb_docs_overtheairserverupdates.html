<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GameDB: overtheairserverupdates</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GameDB
   &#160;<span id="projectnumber">1.5.0</span>
   </div>
   <div id="projectbrief">GameDB Pro is a plugin that provides an easy to use and powerful game and meta data editor</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md__d_1__workspace_gamedb_docs_overtheairserverupdates.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">overtheairserverupdates </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#serverpage">WIP: Server and over the air updates </a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="serverpage"></a>
WIP: Server and over the air updates </h1>
<p>(Pro version only)</p>
<h2>Overview</h2>
<p>The GameDB (Pro) plugin provides functionality for uploading and downloading a gameDB to/from a server. Effectively allowing over the air updates of your data without the need to republish or resubmit your app before getting an update out to users.</p>
<p>Included in the plugin is a server written in Golang that interfaces with AWS and S3/DynamoDB to manage the updates and the uploaded files. This server can be used as is or is provided as an example for writing your own or integrating it with other infrastructure.</p>
<p>The plugin also contains high level helper functions to retrieve the data but also provides APIs for doing most of the separate tasks yourself if custom integration with your app is required.</p>
<p>The data uploaded and downloaded from the server is both compressed and encrypted (more info HERE) and is only a diff between a base version of the data and the current revision meaning it is as small and efficient as possible. The diff format is that defined by the JSON Patch format <a href="http://jsonpatch.com/">http://jsonpatch.com/</a>.</p>
<h2>Setup</h2>
<h3>Server</h3>
<p>The provided server is easily built and deployed as it comes with build scripts and a docker file. Extra work will be required to integrate it with pre-existing infrastructure but deployment won't be covered here, though I can be contacted to discuss options of providing support to help you deploy the server (This will be charged extra to the price of the plugin)</p>
<p>The server was built using golang version go1.8.3. While earlier or later versions are likely to work just fine, I suggest you use the recommended version to avoid any issues.</p>
<p>Some prerequisite software will need to be installed:</p>
<ul>
<li>golang 1.8.3 <a href="https://golang.org/dl/">https://golang.org/dl/</a></li>
<li>glide <a href="https://github.com/Masterminds/glide">https://github.com/Masterminds/glide</a></li>
<li>docker <a href="https://www.docker.com/">https://www.docker.com/</a></li>
</ul>
<p>Within the <em>Assets/Plugin/GameDBLibary</em> folder is a <em>server.zip</em> that you should extract to your go workspace <a href="https://golang.org/doc/install">https://golang.org/doc/install</a>.</p>
<p>You will then need to in the root of the server directory run the command <code>glide install</code> this will download and install all the required dependencies for the server.</p>
<p>After this has been completed you can proceed to build the server by running <code>./build.sh</code>. This will compile the executable and build a docker image ready to deploy or test.</p>
<p>Next step is to setup the AWS services you will be interfacing with. This guide won't go into detail on how to set these up but will outline the requirements (If you need extra support feel free to contact me).</p>
<p><em><b>S3</b></em> You will need to either create or use an existing S3 bucket. Files will be uploaded here that will have ACLs set to public-read (If you would rather these are access controlled you will need to modify the server and client to support this).</p>
<p><em><b>DynamoDB</b></em> You will need a DynamoDB table set up that has a <em>Partition key</em> called <em>tag</em> as a string type and a <em>Sort key</em> called <em>scope</em> as a string type. Records regarding the uploaded files will be stored here.</p>
<p>Before testing the server a configuration file needs to be defined see configuration section <a href="#server-configuration">below</a></p>
<p>Once you have a <em>conf.yaml</em> that suits your needs then you can start the docker container for testing by running <code>docker run --v ./conf.yaml:/app/conf.yaml ***TODO GET ACTUAL COMMAND***</code></p>
<h3>GameDB Plugin</h3>
<p>To connect the Unity plugin to the server for uploading and managing deployed gameDBs you will need to configure the URLs for your server and for the S3 bucket you previously setup.</p>
<p>To do this open the GameDB Editor by going to <em><b>Window &gt; GameDB &gt; Open Editor</b></em> then in the editor window navigate to the <em>Deployment</em> tab.</p>
<p>There should then be a <em>Deploy to Server</em> section you can expand where you will see two entry fields for <em>GameDB Server Host</em> and <em>Download Server Host</em>. Assuming you have a server deployed or running locally you can set these then you should be able to start deploying gameDBs.</p>
<p>Example values for the host fields are: <em>GameDB Server Host</em>: <a href="http://localhost:8000">http://localhost:8000</a> (if running it locally for testing) <em>Download Server Host</em>: <a href="https://s3-eu-west-1.amazonaws.com/mybucket">https://s3-eu-west-1.amazonaws.com/mybucket</a></p>
<h3>Server Configuration</h3>
<p>The server can be configured in a few different ways. These include via a conf.yaml file, or a combination of the conf.yaml and environment variables.</p>
<p>Below is an example conf.yaml file and then an explanation of what each value configures: </p><pre class="fragment">server:
  port: 8000               //The port the server listens on. Recommended to leave as default as the docker container exposes this port
  writeTimeout: 30         //Timeout in seconds for writing a http response
  readTimeout: 30          //Timeout in seconds for reading a http request
  formBufferSize: 10485760 //Max size in bytes for uploaded POST data and parameters

aws:                       //The AWS config can also be set via environment variables listed here: http://docs.aws.amazon.com/cli/latest/userguide/cli-environment.html if using environment variables for AWS don't set any thing in the conf.yaml (delete the whole AWS section)
  id: ""                   //AWS Credentials ID
  secret: ""               //AWS Credentials Secret
  region: "eu-west-1"      //AWS Region for S3 bucket and DynamoDB table

gamedb:
  dynamodb:
    tableName: "gamedb"    //Name of previously created DynamoDB table in configured region. Can also be set by environment variable GDB_GAMEDB_DYNAMODB_TABLENAME
  s3:
    bucket: "mybucket"     //Name of previously created S3 bucket in configured region. Can also be set by environment variable GDB_GAMEDB_S3_BUCKET
    storageRoot: "gamedb"  //Top level directory name to store files in, in S3 bucket. Can also be set by environment variable GDB_GAMEDB_S3_STORAGEROOT
  encryption:
    key: "somekey"         //A secure key to use for encrypting uploaded gameDB data to be downloaded by clients.
    salt: "somesalt"       //A secure salt to use for encrypting uploaded gameDB data to be downloaded by clients

logging:
  level: "info"            //Log level to use can be set based on available log levels here: https://github.com/sirupsen/logrus#level-logging
</pre><h2>Usage</h2>
<h3>Deploying a gameDB</h3>
<p>The GameDB Editor allows you to upload and publish the currently loaded gameDB. This makes it easy to make a change to your data and get it onto a server quickly and efficiently.</p>
<p><em><b>Terminology</b></em> Deployment: A deployment is a set of revision for a particular gameDB scoped by the Scope Name of the uploaded gameDB and by a Tag. A deployment contains information about the current deployed version plus all past/future revisions.</p>
<p>Tag: A tag is an arbitrary label applied to a particular deployment of a gameDB. Generally this will be something like the client version the gameDB is intended for (ie. 1.1.3) or could be an identifier (ie. open beta). This allows different versions of the same gameDB to be deployed for different needs. If the schema for a gameDB changes so should the tag it is deployed against.</p>
<p>Revision: A revision is a particular incremental change of data for a particular gameDB and tag. Meaning if you make a change to the data without changing schema and you intend to update it for a already deployed gameDB it will be treated as a revision of the server. Which causes it to detect only the differences between the original uploaded gameDB for a particular gameDB/tag and store that only saving bandwidth when the client downloads the new data.</p>
<p><em><b>Retrieving Deployments</b></em> On the <em>Deployment</em> tab of the GameDB Editor, if you expand the <em>Deploy to Server</em> section, you can click the <em>Retrieve Deployments</em> button to query the server for the current list of deployments for the current gameDB. If you have gameDBs already deployed this will update the Tag and Revision drop-downs below.</p>
<p><em><b>Uploading a new revision</b></em> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
